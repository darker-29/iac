AWSTemplateFormatVersion: "2010-09-09"
Description: Template generated by rain

Parameters:
  Env:
    Type: String
    Default: test

Resources:
  MyDBInstance:
    Type: AWS::RDS::DBInstance
    Properties:
      AvailabilityZone: ap-northeast-1a
      MultiAZ: false
      DBInstanceClass: db.t3.micro
      DBInstanceIdentifier: !Ref Name
      Engine: postgres
      EngineVersion: 13.5
      MasterUserPassword: testpass
      MasterUsername: testuser
      DBName: test
      Port: 3306
      StorageType: standard
      AllocatedStorage: 20
      VPCSecurityGroups:
        - CHANGEME
      DBParameterGroupName: !Ref DBParameterGroup
        #OptionGroupName: !Ref OptionGroup
      AllowMajorVersionUpgrade: false
      AutoMinorVersionUpgrade: true
      PubliclyAccessible: false
      StorageEncrypted: false
      BackupRetentionPeriod: 30
      CopyTagsToSnapshot: false
      DeleteAutomatedBackups: true
      DeletionProtection: false
      EnableIAMDatabaseAuthentication: false
      EnablePerformanceInsights: false
      Tags:
        - Key: Name
          Value: !Sub ${Env}-db
        # EnableCloudwatchLogsExports:
        #   - CHANGEME
        # PerformanceInsightsRetentionPeriod: 0 # Optional
        # PerformanceInsightsKMSKeyId: CHANGEME # Optional
        # MonitoringInterval: 0 # Optional
        # MonitoringRoleArn: CHANGEME # Optional


  DBParameterGroup:
    Type: AWS::RDS::DBParameterGroup
    Properties:
      Description: test db parametergroup
      Family: postgres13
        #Parameters:
        #  CHANGEME: 
      Tags:
        - Key: Name
          Value: !Sub ${Env}-db

            #OptionGroup:
            #  Type: AWS::RDS::OptionGroup
            #  Properties:
            #    EngineName: CHANGEME
            #    MajorEngineVersion: CHANGEME
            #    OptionConfigurations:
            #      - DBSecurityGroupMemberships: # Optional
            #          - CHANGEME
            #        OptionName: CHANGEME
            #        OptionSettings: # Optional
            #          - Name: CHANGEME # Optional
            #            Value: CHANGEME # Optional
            #        OptionVersion: CHANGEME # Optional
            #        Port: 0 # Optional
            #        VpcSecurityGroupMemberships: # Optional
            #          - CHANGEME
            #    OptionGroupDescription: CHANGEME
            #    Tags:
            #      - Key: CHANGEME
            #        Value: CHANGEME

